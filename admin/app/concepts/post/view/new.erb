<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header"><%= form_action_title %> Post <%= preview_link %></h1>
  </div>
</div>

<% f = form(model, form_path, builder: :bootstrap3, id: 'post-form') %>
<%= f.start %>
<%= f.error_notification %>
<div class="row">
  <div class="col-sm-6">
    <%= f.input :title, label: 'Title' %>
    <%= f.input :slug, label: 'Slug' %>
  </div>
  <div class="col-sm-6">
    <%= f.input :seo_description, label: 'Seo Description' %>
    <%= f.input :seo_keywords, label: 'Seo Keywords' %>
  </div>
</div>
<%= f.input :tags, label: 'Tags' %>
<%= f.error :content %>
<%= f.hidden :content, value: '' %>
<div class="editable"><%= model.content %></div>
<%= f.checkbox :active, label: 'Active', value: model.active %>
<%= f.submit value: 'Save', class: %w(btn-lg btn-success) %>
<%= f.end %>
<script>
  $(function () {
    $("#post-form").submit(function (event) {
      event.preventDefault();
      var contentObj = editor.serialize();
      $("#content").val(contentObj['element-0'].value);
      this.submit();
    });

    var editor = new MediumEditor('.editable', {
      buttonLabels: 'fontawesome',
      extensions: {
        table: new MediumEditorTable(),
        embedButton: new EmbedButtonExtension({
          embedOpts: {
            oembedProxy: "https://iframe.ly/api/oembed?api_key=cfbfb6143da0b54b3c938a&url="
          }
        })
      },
      toolbar: {
        buttons: [
          'bold',
          'italic',
          'underline',
          'anchor',
          'h2',
          'h3',
          'quote',
          'unorderedlist',
          'orderedlist',
          'image',
          'embedButton',
          'table',
          'removeFormat'
        ]
      },
      static: true,
      sticky: true
    });
  });
</script>